{
    "contents" : "#logistic regression model\nres.bact<-cbind(f.dat$n_pos_bact,f.dat$n_neg_bact)\nglm.res.bact <- glm(res.bact ~ f.dat$Bath_lnconc + f.dat$CHR_lnconc + f.dat$Drain_lnconc + f.dat$Part_lnconc + f.dat$Piped_lnconc +\n                        f.dat$Pro_lnconc + f.dat$Swab_lnconc + f.dat$TFSR_lnconc + f.dat$sewage.length + f.dat$street.length +\n                        f.dat$dist2fecal + f.dat$dist2sewage + f.dat$dist2street + f.dat$cnt.child, family=binomial(link='logit'))\n\nsummary(glm.res.bact)\n#hist(glm.res.bact$residuals)\n\nres.virus<-cbind(f.dat$n_pos_virus,f.dat$n_neg_virus)\nglm.res.virus <- glm(res.virus ~ f.dat$Bath_lnconc + f.dat$CHR_lnconc + f.dat$Drain_lnconc + f.dat$Part_lnconc + f.dat$Piped_lnconc +\n                      f.dat$Pro_lnconc + f.dat$Swab_lnconc + f.dat$TFSR_lnconc + f.dat$sewage.length + f.dat$street.length +\n                      f.dat$dist2fecal + f.dat$dist2sewage + f.dat$dist2street + f.dat$cnt.child, family=binomial(link='logit'))\n\nsummary(glm.res.virus)\n\nres.ill<-round(f.dat$n_illness/as.numeric(f.dat$duration)*365)\nglm.res.ill <- glm(res.ill ~ f.dat$Bath_lnconc + f.dat$CHR_lnconc + f.dat$Drain_lnconc + f.dat$Part_lnconc + f.dat$Piped_lnconc +\n                     f.dat$Pro_lnconc + f.dat$Swab_lnconc + f.dat$TFSR_lnconc + f.dat$sewage.length + f.dat$street.length +\n                     f.dat$dist2fecal + f.dat$dist2sewage + f.dat$dist2street + f.dat$cnt.child, family=poisson(link='log'))\n\nsummary(glm.res.ill)\n\n#Univariate logistic regression\nres.bact<-cbind(f.dat$n_pos_bact,f.dat$n_neg_bact)\nres.virus<-cbind(f.dat$n_pos_virus,f.dat$n_neg_virus)\nres.ill<-round(f.dat$n_illness/as.numeric(f.dat$duration)*365)\n\n#Bacteria\nglm.res.bact <- glm(res.bact ~ f.dat$Bath_lnconc, family=binomial(link='logit'))\nsummary(glm.res.bact)\nglm.res.bact <- glm(res.bact ~ f.dat$CHR_lnconc, family=binomial(link='logit'))\nsummary(glm.res.bact)\nglm.res.bact <- glm(res.bact ~ f.dat$Drain_lnconc, family=binomial(link='logit'))\nsummary(glm.res.bact)\nglm.res.bact <- glm(res.bact ~ f.dat$Part_lnconc, family=binomial(link='logit'))\nsummary(glm.res.bact)\nglm.res.bact <- glm(res.bact ~ f.dat$Piped_lnconc, family=binomial(link='logit'))\nsummary(glm.res.bact)\nglm.res.bact <- glm(res.bact ~ f.dat$Pro_lnconc, family=binomial(link='logit'))\nsummary(glm.res.bact)\nglm.res.bact <- glm(res.bact ~ f.dat$Swab_lnconc, family=binomial(link='logit'))\nsummary(glm.res.bact)\nglm.res.bact <- glm(res.bact ~ f.dat$TFSR_lnconc, family=binomial(link='logit'))\nsummary(glm.res.bact)\nglm.res.bact <- glm(res.bact ~ f.dat$sewage.length, family=binomial(link='logit'))\nsummary(glm.res.bact)\nglm.res.bact <- glm(res.bact ~ f.dat$street.length, family=binomial(link='logit'))\nsummary(glm.res.bact)\nglm.res.bact <- glm(res.bact ~ f.dat$dist2fecal, family=binomial(link='logit'))\nsummary(glm.res.bact)\nglm.res.bact <- glm(res.bact ~ f.dat$dist2sewage, family=binomial(link='logit'))\nsummary(glm.res.bact)\nglm.res.bact <- glm(res.bact ~ f.dat$dist2street, family=binomial(link='logit'))\nsummary(glm.res.bact)\nglm.res.bact <- glm(res.bact ~ f.dat$cnt.child, family=binomial(link='logit'))\nsummary(glm.res.bact)\n\n#Virus\nglm.res.virus <- glm(res.virus ~ f.dat$Bath_lnconc, family=binomial(link='logit'))\nsummary(glm.res.virus)\nglm.res.virus <- glm(res.virus ~ f.dat$CHR_lnconc, family=binomial(link='logit'))\nsummary(glm.res.virus)\nglm.res.virus <- glm(res.virus ~ f.dat$Drain_lnconc, family=binomial(link='logit'))\nsummary(glm.res.virus)\nglm.res.virus <- glm(res.virus ~ f.dat$Part_lnconc, family=binomial(link='logit'))\nsummary(glm.res.virus)\nglm.res.virus <- glm(res.virus ~ f.dat$Piped_lnconc, family=binomial(link='logit'))\nsummary(glm.res.virus)\nglm.res.virus <- glm(res.virus ~ f.dat$Pro_lnconc, family=binomial(link='logit'))\nsummary(glm.res.virus)\nglm.res.virus <- glm(res.virus ~ f.dat$Swab_lnconc, family=binomial(link='logit'))\nsummary(glm.res.virus)\nglm.res.virus <- glm(res.virus ~ f.dat$TFSR_lnconc, family=binomial(link='logit'))\nsummary(glm.res.virus)\nglm.res.virus <- glm(res.virus ~ f.dat$sewage.length, family=binomial(link='logit'))\nsummary(glm.res.virus)\nglm.res.virus <- glm(res.virus ~ f.dat$street.length, family=binomial(link='logit'))\nsummary(glm.res.virus)\nglm.res.virus <- glm(res.virus ~ f.dat$dist2fecal, family=binomial(link='logit'))\nsummary(glm.res.virus)\nglm.res.virus <- glm(res.virus ~ f.dat$dist2sewage, family=binomial(link='logit'))\nsummary(glm.res.virus)\nglm.res.virus <- glm(res.virus ~ f.dat$dist2street, family=binomial(link='logit'))\nsummary(glm.res.virus)\nglm.res.virus <- glm(res.virus ~ f.dat$cnt.child, family=binomial(link='logit'))\nsummary(glm.res.virus)\n#Virus seems not association with log10 E. coli concentration for all pathways\n\n#Illness\nglm.res.ill <- glm(res.ill ~ f.dat$Bath_lnconc, family=poisson(link='log'))\nsummary(glm.res.ill)\nglm.res.ill <- glm(res.ill ~ f.dat$CHR_lnconc, family=poisson(link='log'))\nsummary(glm.res.ill)\nglm.res.ill <- glm(res.ill ~ f.dat$Drain_lnconc, family=poisson(link='log'))\nsummary(glm.res.ill)\nglm.res.ill <- glm(res.ill ~ f.dat$Part_lnconc, family=poisson(link='log'))\nsummary(glm.res.ill)\nglm.res.ill <- glm(res.ill ~ f.dat$Piped_lnconc, family=poisson(link='log'))\nsummary(glm.res.ill)\nglm.res.ill <- glm(res.ill ~ f.dat$Pro_lnconc, family=poisson(link='log'))\nsummary(glm.res.ill)\nglm.res.ill <- glm(res.ill ~ f.dat$Swab_lnconc, family=poisson(link='log'))\nsummary(glm.res.ill)\nglm.res.ill <- glm(res.ill ~ f.dat$TFSR_lnconc, family=poisson(link='log'))\nsummary(glm.res.ill)\nglm.res.ill <- glm(res.ill ~ f.dat$sewage.length, family=poisson(link='log'))\nsummary(glm.res.ill)\nglm.res.ill <- glm(res.ill ~ f.dat$street.length, family=poisson(link='log'))\nsummary(glm.res.ill)\nglm.res.ill <- glm(res.ill ~ f.dat$dist2fecal, family=poisson(link='log'))\nsummary(glm.res.ill)\nglm.res.ill <- glm(res.ill ~ f.dat$dist2sewage, family=poisson(link='log'))\nsummary(glm.res.ill)\nglm.res.ill <- glm(res.ill ~ f.dat$dist2street, family=poisson(link='log'))\nsummary(glm.res.ill)\nglm.res.ill <- glm(res.ill ~ f.dat$cnt.child, family=poisson(link='log'))\nsummary(glm.res.ill)\n\n#model selection\n#Bacteria\n#AIC\nglm.res.bact <- glm(res.bact ~ f.dat$Bath_lnconc + f.dat$CHR_lnconc + f.dat$Drain_lnconc + f.dat$Part_lnconc + f.dat$Piped_lnconc +\n                      f.dat$Pro_lnconc + f.dat$Swab_lnconc + f.dat$TFSR_lnconc + f.dat$sewage.length + f.dat$street.length +\n                      f.dat$dist2fecal + f.dat$dist2sewage + f.dat$dist2street + f.dat$cnt.child, family=binomial(link='logit'))\nstep(glm.res.bact)\n\nglm.res.bact.aic <- glm(res.bact ~ f.dat$CHR_lnconc + f.dat$Drain_lnconc + \n                        f.dat$Part_lnconc + f.dat$TFSR_lnconc + f.dat$sewage.length + \n                        f.dat$cnt.child, family = binomial(link = \"logit\"))\nsummary(glm.res.bact.aic)\n\n#BIC\nstep(glm.res.bact,k=log(165))\n\n#Virus\n#AIC\nglm.res.virus <- glm(res.virus ~ f.dat$Bath_lnconc + f.dat$CHR_lnconc + f.dat$Drain_lnconc + f.dat$Part_lnconc + f.dat$Piped_lnconc +\n                      f.dat$Pro_lnconc + f.dat$Swab_lnconc + f.dat$TFSR_lnconc + f.dat$sewage.length + f.dat$street.length +\n                      f.dat$dist2fecal + f.dat$dist2sewage + f.dat$dist2street + f.dat$cnt.child, family=binomial(link='logit'))\nstep(glm.res.virus)\n\nglm.res.virus.aic <- glm(res.virus ~ f.dat$Drain_lnconc + f.dat$Pro_lnconc + \n                           f.dat$Swab_lnconc + f.dat$street.length, family = binomial(link = \"logit\"))\nsummary(glm.res.virus.aic)\n\n#BIC\nstep(glm.res.virus,k=log(165))\n\n#illness\n#AIC\nglm.res.ill <- glm(res.ill ~ f.dat$Bath_lnconc + f.dat$CHR_lnconc + f.dat$Drain_lnconc + f.dat$Part_lnconc + f.dat$Piped_lnconc +\n                       f.dat$Pro_lnconc + f.dat$Swab_lnconc + f.dat$TFSR_lnconc + f.dat$sewage.length + f.dat$street.length +\n                       f.dat$dist2fecal + f.dat$dist2sewage + f.dat$dist2street + f.dat$cnt.child, family=poisson(link='log'))\nstep(glm.res.ill)\n\n#BIC\nstep(glm.res.ill,k=log(165))\n\n\n",
    "created" : 1469731833972.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "259612238",
    "id" : "C9BBBF79",
    "lastKnownWriteTime" : 1470149956,
    "path" : "~/stat/CMC/v4/v4.glm.r",
    "project_path" : "v4.glm.r",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "type" : "r_source"
}